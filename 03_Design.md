# YouTube-like System Design: Detailed Components (AWS)

## Core Components & AWS Mappings

![](https://i.postimg.cc/Zq29qRHx/01-Architecture-Flow.png)

| Component               | AWS Service                     | Purpose                                                                 |
|-------------------------|---------------------------------|-------------------------------------------------------------------------|
| **Load Balancers**      | ELB/ALB                         | Distribute user requests across EC2 web servers.                        |
| **Web Servers**         | EC2 (Auto Scaling)              | Handle user requests (e.g., Apache/Lighttpd for static content).        |
| **Application Servers** | ECS/EKS (Dockerized)            | Host business logic, interact with databases, and prepare responses.    |
| **User Data Storage**   | DynamoDB + Cognito              | Store user profiles and authentication data (NoSQL for scalability).    |
| **Video Metadata**      | DynamoDB + ElastiCache (Redis)  | Decouple frequently accessed metadata (titles, likes, comments).        |
| **Upload Storage**      | S3 (Temporary)                  | Store raw videos before encoding (lifecycle policies for cleanup).      |
| **Thumbnails (Bigtable)** | S3 + CloudFront                | High-throughput storage + CDN for fast thumbnail delivery.              |
| **Encoders**           | AWS Elemental MediaConvert      | Transcode videos (MPEG-4, VP9) and generate thumbnails.                 |
| **CDN**                | CloudFront                      | Cache popular videos at edge locations for low-latency streaming.       |
| **Colocation Sites**    | AWS Local Zones/Outposts        | Extend AWS infrastructure to remote locations for regional caching.     |
| **Blob Storage**       | S3 (Standard/Infrequent Access) | Store encoded videos in multiple formats.                               |
| **Streaming**          | Amazon IVS or Kinesis Video     | Deliver real-time video streams to end-users.                           |

---

## Design Flow & AWS Technologies

### 1. **Upload Flow**
   - **User** → **EC2 (Web Server)** → **S3 (Upload Storage)**  
   - **Trigger**: S3 event notification → **AWS Lambda** invokes MediaConvert for encoding.  
   - **Output**: Encoded videos stored in S3, thumbnails in S3 + CloudFront.  

### 2. **Streaming Flow**
   - **User** → **CloudFront (CDN)** → **S3/IVS** (if cached, else origin fetch).  
   - **Metadata**: DynamoDB (video info) + ElastiCache (comments/likes).  

### 3. **Data Storage Strategy**
   - **Decoupling**:  
     - **User Data**: DynamoDB (scalable key-value store).  
     - **Video Metadata**: DynamoDB (partitioned by video ID) + ElastiCache for hot data.  
     - **Thumbnails**: S3 (cost-effective) + CloudFront (fast delivery).  
   - **Sharding**: DynamoDB uses automatic partitioning (no manual sharding needed).  

### 4. **Encoding Pipeline**
   - **MediaConvert** processes videos into formats (e.g., 144p to 4K).  
   - **Thumbnails**: Generated by MediaConvert → Stored in S3.  
   - **Metadata Updates**: Lambda triggers DynamoDB writes post-encoding.  

---

## Key AWS Optimizations

### Scalability
   - **EC2 Auto Scaling**: Handle traffic spikes (web/app servers).  
   - **DynamoDB**: Auto-scaling based on request capacity.  
   - **S3**: Unlimited storage + multi-part uploads for large files.  

### Performance
   - **Caching**:  
     - CloudFront (videos/thumbnails).  
     - ElastiCache (Redis) for metadata/comments.  
   - **Low Latency**: AWS Local Zones for colocation near users.  

### Reliability
   - **S3 Durability**: 99.999999999% (11 nines).  
   - **Multi-AZ Deployments**: RDS (if SQL needed) + DynamoDB global tables.  

---

## Technology Choices
| Requirement              | AWS Service              | Rationale                                                                 |
|--------------------------|--------------------------|---------------------------------------------------------------------------|
| **Static Content**       | S3 + CloudFront          | Low-latency delivery with edge caching.                                   |
| **Dynamic Content**      | EC2 + ALB                | Decoupled web/application servers for flexibility.                        |
| **High-Throughput DB**   | DynamoDB                 | NoSQL, auto-scaling, and single-digit millisecond latency.                |
| **Real-Time Streaming**  | Amazon IVS               | Managed live-streaming service with adaptive bitrate.                     |
| **Cost-Effective Storage** | S3 Lifecycle Policies  | Move older videos to S3 Glacier after a period.                           |
